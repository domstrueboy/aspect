<!--Программа для решения выражения, введенного с клавиатуры. Допускаются операции +, -, *, / , скобки, а также числа с плавающей точкой. Пробелы игнорируются. Функция степени не реализована (т.к. в примере на бумажке такой операции не было). Вложенные скобки допускаются.-->
<!DOCTYPE html>
<html>
  <head>
    <title>Решение выражения</title>
    <meta charset=UTF-8>
</head>

<body>
<script>
    var text = prompt("Выражение:",""); //ввод выражения с клавиатуры

    var arr1 = text.split("");//разбиение на массив отдельных символов

    var arr2 = arr1; //создаём массив, куда будем передавать выражение с удаленными пробелами
    var j = 0; //счетчик "нормальных" символов, т.е. не пробелов
      for (var i=0, len=arr1.length; i<len; i++) { // этим циклом удаляем пробелы из выражения
        if (arr1[i]!=" "){ 
                            arr2[j]=arr1[i]; j++;
                          }
                                                }
      arr2.splice(j); //подрезаем массив - удаляем все непреобразованные элементы
      
      //алгоритм Дейкстры///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      var stek = []; //стек
      var arr3 = []; //выходная последовательность
      var dlina = 0; //индикатор длинного числа
      var val=0, val_temp=0; //значение числа
      var ii=0; //положения открывающей и закрывающей скобок в стеке

      for (i=0, len=arr2.length; i<len; i++){ //этот цикл формирует выходную последовательность
        if(arr2[i]==1||arr2[i]==2||arr2[i]==3||arr2[i]==4||arr2[i]==5||arr2[i]==6||arr2[i]==7||arr2[i]==8||arr2[i]==9||arr2[i]==0||arr2[i]=='.'){//этот if группирует соседние цифры в одно число и помещает их в выходную последовательность
                        dlina++;
                        if(dlina==1){ j = arr3.push(arr2[i]) - 1; }
                        val_temp = arr2[i]; 
               
                        if(dlina>1){
                                    arr3[j] = val+val_temp;//Складываем символы
                                    }
                        val = arr3[j]; arr3[j]=parseFloat(val);//Преобразуем строковое значение выходной последовательности в число типа float
                      }
        else{ val = 0; val_temp = 0; dlina = 0; }//Обнуляем значения вспомогательных переменных, подготавливая их для записи следующего числа

        if (arr2[i]=='('){ stek.push(arr2[i]);}//помещаем ( в стек
        if (arr2[i]==')'){ for(ii=stek.length-1; ii>=0; ii--){ //этот цикл помещает содержимое стека между скобками в выходную последовательность, и удаляет скобки.
                                                               if(stek[ii]!='('){arr3.push(stek[ii]); stek.pop();}
                                                               else {stek.pop(); break;
                                                                                }
                                                              }
                           if(stek[ii-1]=='+'||stek[ii-1]=='-'||stek[ii-1]=='*'||stek[ii-1]=='/'){ //если перед ( есть знак операции, помещаем его в выходную последовательность.
                                                                                                    arr3.push(stek[ii-1]); stek.pop();
                                                                                                  }
                                          
                         }
        if (arr2[i]=='+'||arr2[i]=='-'){ //Этот if при чтении знака операции выталкивает из стека в выходную последовательность операции с большим либо равным приоритетом (т.е. все: +, -, *, /) до тех пор пока не встретится операция с меньшим приоритетом либо (.
                                          if(stek.length>0){
                                          for(ii=stek.length-1; ii>=0; ii--){
                                                                                    if(stek[ii]!='('){arr3.push(stek[ii]);
                                                                                      stek.pop();}
                                                                                    else break;
                                                                            }
                                                            }
                                          stek.push(arr2[i]);
                                        }
        if (arr2[i]=='*'||arr2[i]=='/'){ //Этот if при чтении знака операции выталкивает из стека в выходную последовательность операции с большим либо равным приоритетом (т.е.:  *, /) до тех пор пока не встретится операция с меньшим приоритетом либо (.
                                          if(stek.length>0){
                                          for(ii=stek.length-1; ii>=0; ii--){

                                                                                    if(stek[ii]=='*'||stek[ii]=='/'){arr3.push(stek[ii]);
                                                                                      stek.pop();}
                                                                                    else break;
                                                                            }
                                                            }
                                          stek.push(arr2[i]);
                                        }


                                             }
      for(ii=stek.length-1; ii>=0; ii--){arr3.push(stek[ii]); stek.pop();} //По завершении чтения (символы закончились), содержимое стека выталкивается в выходную последовательность. Выходная последовательность теперь представляет собой эквивалент входного выражения, но только в постфиксной записи.

//Теперь можно решать выражение в постфиксной записи//////////////////////////////////////////////////////////////////////////////////////////////////////
for(i=0, len=arr3.length; i<len; i++){//цикл перебирает все элементы выходного выражения
                                        if(arr3[i]>-1000000 && arr3[i]<1000000){stek.push(arr3[i]);}//если это число от -1000000 до 1000000, то оно помещается в стек
                                        if(arr3[i]=='+'){  var res1=stek.pop();//если это операция сложения, то последний и предпоследний элемент складываются, результат помещается в стек вместо предпоследнего числа
                                                           var res2=stek.pop();
                                                           stek.push(res2+res1);
                                                         }
                                        if(arr3[i]=='-'){  var res1=stek.pop();//так же, как со сложением
                                                           var res2=stek.pop();
                                                           stek.push(res2-res1);
                                                         }
                                        if(arr3[i]=='*'){  var res1=stek.pop();
                                                           var res2=stek.pop();
                                                           stek.push(res2*res1);
                                                         }
                                        if(arr3[i]=='/'){  var res1=stek.pop();
                                                           var res2=stek.pop();
                                                           stek.push(res2/res1);
                                                         }
                                      }
                                      
                                      alert(stek); // Содержимое стека и есть искомый результат. 

</script>
</body>
</html>